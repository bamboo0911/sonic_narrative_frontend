{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Link,useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MainPage=()=>{const[location,setLocation]=useState({latitude:null,longitude:null});const[hasWritten,setHasWritten]=useState(false);// 用于跟踪 Writing Page 的状态\nconst[textData,setTextData]=useState('');// 用于存储写作页面的文本\nconst navigate=useNavigate();useEffect(()=>{// 检查用户是否在 Writing Page 中输入了数据\nconst writtenStatus=localStorage.getItem('hasWritten');const storedText=localStorage.getItem('textData');// 获取文本数据\nif(writtenStatus&&storedText){setHasWritten(true);setTextData(storedText);// 将文本数据保存到状态中\n}if(navigator.geolocation){navigator.geolocation.getCurrentPosition(position=>{setLocation({latitude:position.coords.latitude,longitude:position.coords.longitude});},error=>{console.error(\"Error fetching geolocation: \",error);});}else{alert(\"Geolocation is not supported by this browser.\");}},[]);const handleSubmitToAI=()=>{const data=textData;// 使用存储的文本数据\nif(!data){console.error('No text data to submit');return;}fetch('http://localhost:5000/api/submit',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text:data})// 发送文本数据到后端\n}).then(response=>{console.log(\"Response received:\",response);return response.json();}).then(result=>{console.log(\"Generated text:\",result.generatedText);localStorage.removeItem('textData');// 清空文本数据\nlocalStorage.removeItem('hasWritten');// 清空已写入的标志\nsetHasWritten(false);// 更新状态\nsetTextData('');// 清空文本数据状态\nnavigate('/ai-result');}).catch(error=>{console.error('Error submitting to AI:',error);});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Main Page\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Your current location is:\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Latitude: \",location.latitude?location.latitude:\"Fetching...\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Longitude: \",location.longitude?location.longitude:\"Fetching...\"]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'20px'},children:/*#__PURE__*/_jsx(Link,{to:\"/recording\",children:/*#__PURE__*/_jsx(\"button\",{children:\"Start Recording\"})})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'20px'},children:/*#__PURE__*/_jsx(Link,{to:\"/photo\",children:/*#__PURE__*/_jsx(\"button\",{children:\"Take Photo\"})})}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'20px'},children:[/*#__PURE__*/_jsx(Link,{to:\"/writing\",children:/*#__PURE__*/_jsx(\"button\",{style:{backgroundColor:hasWritten?'green':'blue'},children:hasWritten?'Writing Completed':'Start Writing'})}),hasWritten&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'10px',color:'green'},children:[/*#__PURE__*/_jsx(\"p\",{children:textData}),\" \"]})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'20px'},children:/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmitToAI,children:\"Submit to AI\"})})]});};export default MainPage;","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","jsx","_jsx","jsxs","_jsxs","MainPage","location","setLocation","latitude","longitude","hasWritten","setHasWritten","textData","setTextData","navigate","writtenStatus","localStorage","getItem","storedText","navigator","geolocation","getCurrentPosition","position","coords","error","console","alert","handleSubmitToAI","data","fetch","method","headers","body","JSON","stringify","text","then","response","log","json","result","generatedText","removeItem","catch","children","style","marginTop","to","backgroundColor","color","onClick"],"sources":["/home/bamboo0911/my-pwa-app/frontend/src/components/MainPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\n\r\nconst MainPage = () => {\r\n  const [location, setLocation] = useState({ latitude: null, longitude: null });\r\n  const [hasWritten, setHasWritten] = useState(false); // 用于跟踪 Writing Page 的状态\r\n  const [textData, setTextData] = useState(''); // 用于存储写作页面的文本\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    // 检查用户是否在 Writing Page 中输入了数据\r\n    const writtenStatus = localStorage.getItem('hasWritten');\r\n    const storedText = localStorage.getItem('textData'); // 获取文本数据\r\n\r\n    if (writtenStatus && storedText) {\r\n      setHasWritten(true);\r\n      setTextData(storedText); // 将文本数据保存到状态中\r\n    }\r\n\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition((position) => {\r\n        setLocation({\r\n          latitude: position.coords.latitude,\r\n          longitude: position.coords.longitude\r\n        });\r\n      }, (error) => {\r\n        console.error(\"Error fetching geolocation: \", error);\r\n      });\r\n    } else {\r\n      alert(\"Geolocation is not supported by this browser.\");\r\n    }\r\n  }, []);\r\n\r\n  const handleSubmitToAI = () => {\r\n    const data = textData; // 使用存储的文本数据\r\n    if (!data) {\r\n      console.error('No text data to submit');\r\n      return;\r\n    }\r\n\r\n    fetch('http://localhost:5000/api/submit', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ text: data }), // 发送文本数据到后端\r\n    })\r\n    .then(response => {\r\n      console.log(\"Response received:\", response);\r\n      return response.json();\r\n    })\r\n    .then(result => {\r\n      console.log(\"Generated text:\", result.generatedText);\r\n      localStorage.removeItem('textData'); // 清空文本数据\r\n      localStorage.removeItem('hasWritten'); // 清空已写入的标志\r\n      setHasWritten(false); // 更新状态\r\n      setTextData(''); // 清空文本数据状态\r\n      navigate('/ai-result');\r\n    })\r\n    .catch(error => {\r\n      console.error('Error submitting to AI:', error);\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1>Main Page</h1>\r\n      <p>Your current location is:</p>\r\n      <p>Latitude: {location.latitude ? location.latitude : \"Fetching...\"}</p>\r\n      <p>Longitude: {location.longitude ? location.longitude : \"Fetching...\"}</p>\r\n  \r\n      <div style={{ marginTop: '20px' }}>\r\n        <Link to=\"/recording\">\r\n          <button>Start Recording</button>\r\n        </Link>\r\n      </div>\r\n  \r\n      <div style={{ marginTop: '20px' }}>\r\n        <Link to=\"/photo\">\r\n          <button>Take Photo</button>\r\n        </Link>\r\n      </div>\r\n  \r\n      <div style={{ marginTop: '20px' }}>\r\n        <Link to=\"/writing\">\r\n          <button style={{ backgroundColor: hasWritten ? 'green' : 'blue' }}>\r\n            {hasWritten ? 'Writing Completed' : 'Start Writing'}\r\n          </button>\r\n        </Link>\r\n        {hasWritten && (\r\n          <div style={{ marginTop: '10px', color: 'green' }}>\r\n            <p>{textData}</p> {/* 显示输入的文本 */}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div style={{ marginTop: '20px' }}>\r\n        <button onClick={handleSubmitToAI}>Submit to AI</button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MainPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}